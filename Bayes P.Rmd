---
title: "Bayes"
author: "GPF"
date: "2022-12-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, include=FALSE}
#if (!require("easypackages")) install.packages("easypackages")
library(easypackages)
libraries("ggplot2", "cmdstanr", "HDInterval", "bayesplot")

# readxl: for reading data set
if (!require(readxl)) install.packages("readxl")
library(readxl)

if (!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager")
BiocManager::install("genefilter", version = "3.15")
if (!requireNamespace("modeest")) install.packages("modeest")
library(modeest)
```

## Data
```{r}
Data = read.csv("DataBayes.csv")
Data = as.data.frame(Data)
Data$CityBlock = Data$CityBlock-16
```


```{r}
## City-Block Model
CityBlock_Model_Syntax = "

data {
  int<lower=0> N;
  vector[N] cityblock;
  int<lower=0, upper=1> acc[N];
}

parameters {
  real alpha;
  real beta;
}

model {
  acc ~ bernoulli_logit(alpha + beta * cityblock);
}

"
```

```{r}
CityBlock_Model_Stan = cmdstan_model(stan_file = write_stan_file(CityBlock_Model_Syntax))

mode04_StanData = list(
  N = nrow(Data),
  acc = Data$accuracy,
  cityblock = Data$CityBlock
)

CityBlock_Model_Samples = CityBlock_Model_Stan$sample(
  data = mode04_StanData,
  seed = 190920221,
  chains = 4,
  parallel_chains = 4,
  iter_warmup = 4000,
  iter_sampling = 4000
)

# assess convergence: summary of all parameters
CityBlock_Model_Samples$summary()

# maximum R-hat
max(CityBlock_Model_Samples$summary()$rhat, na.rm = TRUE)
```


```{r}
## Euclidean Model
Euclidean_Model_Syntax = "
data {
  int<lower=0> N;
  vector[N] Euclidean;
  int<lower=0, upper=1> acc[N];
}

parameters {
  real alpha;
  real beta;
}

model {
  acc ~ bernoulli_logit(alpha + beta * Euclidean);
}

"

Euclidean_Model_Stan = cmdstan_model(stan_file = write_stan_file(Euclidean_Model_Syntax))

mode04_StanData = list(
  N = nrow(Data),
  acc = Data$accuracy,
  Euclidean = Data$Euclidean
)

Euclidean_Model_Samples = Euclidean_Model_Stan$sample(
  data = mode04_StanData,
  seed = 190920221,
  chains = 4,
  parallel_chains = 4,
  iter_warmup = 4000,
  iter_sampling = 4000
)

# assess convergence: summary of all parameters
Euclidean_Model_Samples$summary()

# maximum R-hat
max(Euclidean_Model_Samples$summary()$rhat, na.rm = TRUE)
```






